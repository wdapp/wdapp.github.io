{"version":3,"sources":["webpack:///./src/views/components/controls/Controls.vue?8b74","webpack:///./src/views/components/controls/components/Play.vue?2b46","webpack:///src/views/components/controls/components/Play.vue","webpack:///./src/views/components/controls/components/Play.vue?6d2a","webpack:///./src/views/components/controls/components/Play.vue","webpack:///./src/views/components/controls/components/Back.vue?2323","webpack:///src/views/components/controls/components/Back.vue","webpack:///./src/views/components/controls/components/Back.vue?efa4","webpack:///./src/views/components/controls/components/Back.vue","webpack:///./src/views/components/controls/components/Control.vue?76a8","webpack:///src/views/components/controls/components/Control.vue","webpack:///./src/views/components/controls/components/Control.vue?1123","webpack:///./src/views/components/controls/components/Control.vue","webpack:///./src/views/components/controls/components/ButtonGroup.vue?34f4","webpack:///src/views/components/controls/components/ButtonGroup.vue","webpack:///./src/views/components/controls/components/ButtonGroup.vue?c1d8","webpack:///./src/views/components/controls/components/ButtonGroup.vue","webpack:///./src/common/components/danmaku/Danmaku.vue?2e0a","webpack:///./node_modules/danmaku-plus/dist/danmaku-plus.es5.js","webpack:///src/common/components/danmaku/Danmaku.vue","webpack:///./src/common/components/danmaku/Danmaku.vue?97a6","webpack:///./src/common/components/danmaku/Danmaku.vue","webpack:///src/views/components/controls/Controls.vue","webpack:///./src/views/components/controls/Controls.vue?c19e","webpack:///./src/views/components/controls/Controls.vue","webpack:///./src/common/components/danmaku/Danmaku.vue?e907","webpack:///./src/views/components/controls/components/Play.vue?2657","webpack:///./src/views/components/controls/components/Control.vue?8bcd","webpack:///./src/views/components/controls/Controls.vue?ec73","webpack:///./src/views/components/controls/components/ButtonGroup.vue?b0cd"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","handleControlsClick","ref","directives","name","rawName","value","expression","$event","target","currentTarget","stopPropagation","onControlsTopClick","attrs","isSubShow","hideSwitchBtn","onSwitch","onOpen","playState","onTogglePlay","screenState","onFullScreen","onDanmakuChange","staticRenderFns","class","active","handlePlayClick","props","type","Boolean","default","methods","$emit","component","screenStatus","handleFullScreenClick","onChange","model","callback","$$v","checked","data","_m","handlSwitchClick","toggle","show","switchWindows","openSubWindows","_v","Danmaku","canvas","danmakuConfig","isPause","lastRenderTime","mDanmuTracks","Array","mCanvas","mDanmukuConfig","mCtx","getContext","initRender","prototype","addDanmuTrack","danmuTrack","push","setDanmaku","removeDanmuTrack","filter","item","width","height","window","requestAnimationFrame","renderByAnimationFrame","renderBySetInterval","bind","setInterval","clearRect","_i","_a","length","mDanmuTrack","start","pause","DanmakuPool","size","mPoolSize","mMessagePool","addMessage","msg","addMessages","getMessage","result","i","created","msgs","j","onBaseCreate","removeMessage","index","findIndex","removeMessageByIndex","Number","isInteger","DanmaTrack","danmuPool","danmaTrackConfig","mDanmaMessages","mTrackInfo","maxWidth","top","mDanmuTrackConfig","mDanmuPool","initConfig","danmaku","mDanmaku","ctx","refreshMessage","currentDanmaMessage","onBaseMeasure","onBaseLayout","onBaseDraw","onBaseDestroyed","position","left","AddMessage","console","log","distoryed","extendStatics","d","b","Object","setPrototypeOf","__proto__","p","hasOwnProperty","__extends","__","constructor","create","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","call","pop","BaseMessage","isLayout","_this","onCreate","val","onDestroyed","trackInfo","onMeasure","onLayout","onDraw","TextMessage","_super","textMessageConfig","mMsg","color","strokeColor","fontSize","fontFamily","assign","textAlign","textBaseline","font","res","measureText","fillStyle","strokeText","fillText","ImgMessage","ImgMessageConfig","url","mImg","Image","onload","onerror","document","removeChild","src","style","appendChild","drawImage","ajax","para","tmp","response","e_1","fetch","arrayBuffer","ArrayBuffer","createCommonjsModule","fn","module","exports","omggif","GifWriter","buf","gopts","loop_count","undefined","loop","global_palette","palette","Error","check_palette_and_num_colors","num_colors","gp_num_colors_pow2","background","gp_num_colors","il","rgb","ended","addFrame","x","w","h","indexed_pixels","opts","using_local_palette","min_code_size","delay","disposal","use_transparency","transparent_index","transparent","GifWriterOutputLZWCodeStream","end","getOutputBuffer","setOutputBuffer","getOutputBufferPosition","setOutputBufferPosition","index_stream","cur_subblock","clear_code","code_mask","eoi_code","next_code","cur_code_size","cur_shift","cur","emit_bytes_to_buffer","bit_block_size","emit_code","c","ib_code","code_table","k","cur_key","cur_code","GifReader","pf0","global_palette_flag","num_global_colors_pow2","num_global_colors","global_palette_offset","global_palette_size","no_eof","frames","block_size","pf1","toString","pf2","local_palette_flag","interlace_flag","num_local_colors_pow2","num_local_colors","palette_offset","palette_size","has_local_palette","data_offset","data_length","interlaced","numFrames","loopCount","frameInfo","frame_num","decodeAndBlitFrameBGRA","pixels","frame","num_pixels","Uint8Array","GifReaderLZWOutputIndexStream","trans","framewidth","framestride","xleft","opbeg","opend","scanstride","interlaceskip","r","decodeAndBlitFrameRGBA","code_stream","output","output_length","subblock_size","Int32Array","prev_code","code","chase_code","chase_length","chase","op_end","VideoMessage","_this_1","currentFrameIndex","Uint8ClampedArray","lastFrameDate","Date","getTime","cal","err","newMethod","mGifReader","frame0Info","reader","imageData","ImageData","putImageData","VideoMessageConfig","mIsPlay","mVideo","createElement","addEventListener","preload","play","innerWidth","computed","remHeight","danmakuPool","img","video","init","createDanmakuPool","createImgDanmakuPool","createVideoDanmakuPool","danmakuTrack","imgDanmuTrack","imgDanmuPool","videoDanmuTrack","videoDanmuPool","sendDanmaku","sendImgDanmaku","options","imgDanmu","sendVideoDanmaku","videoDanmu","handlePause","handleStart","mounted","mixins","components","ControlsPlay","ControlsBack","ControlsControl","ControlsButtonGroup","CommonDanmaku","$refs","abort","emit","addEvents"],"mappings":"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","file":"js/chunk-00e82c22.de86de8f.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"controls-wrapper\",on:{\"click\":_vm.handleControlsClick}},[_c('common-danmaku',{ref:\"danmaku\",staticClass:\"danmaku-wrap\"}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.show),expression:\"show\"}],staticClass:\"controls-top\",on:{\"click\":function($event){if($event.target !== $event.currentTarget){ return null; }$event.stopPropagation();return _vm.onControlsTopClick($event)}}},[_c('controls-back',{staticClass:\"controls-back\",on:{\"click\":_vm.handleControlsClick}}),_c('controls-button-group',{staticClass:\"controls-button-group\",attrs:{\"isSubShow\":_vm.isSubShow,\"hideSwitchBtn\":_vm.hideSwitchBtn},on:{\"click\":_vm.handleControlsClick,\"switch\":_vm.onSwitch,\"open\":_vm.onOpen}}),_c('controls-play',{staticClass:\"controls-play\",attrs:{\"playState\":_vm.playState},on:{\"toggleplay\":_vm.onTogglePlay,\"click\":_vm.handleControlsClick}})],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.show),expression:\"show\"}],staticClass:\"controls-bottom\"},[_c('controls-control',{attrs:{\"playState\":_vm.playState,\"fullScreenState\":_vm.screenState},on:{\"toggleplay\":_vm.onTogglePlay,\"fullscreenclick\":_vm.onFullScreen,\"change\":_vm.onDanmakuChange}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"play-wrapper\",class:{ active: _vm.playState },on:{\"click\":_vm.handlePlayClick}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <span\n    @click=\"handlePlayClick\"\n    class=\"play-wrapper\"\n    :class=\"{ active: playState }\"\n  ></span>\n</template>\n\n<script>\nexport default {\n  name: \"Play\",\n  props: {\n    playState: {\n      type: Boolean,\n      default: false\n    }\n  },\n  methods: {\n    handlePlayClick() {\n      this.$emit(\"toggleplay\");\n    }\n  }\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n@import \"~styles/mixins.styl\"\n\n.play-wrapper\n  bg-image('big-play', 90)\n.active\n  active-image('big-pause')\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Play.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Play.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Play.vue?vue&type=template&id=5de8f0e2&scoped=true&\"\nimport script from \"./Play.vue?vue&type=script&lang=js&\"\nexport * from \"./Play.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Play.vue?vue&type=style&index=0&id=5de8f0e2&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5de8f0e2\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('router-link',{attrs:{\"tag\":\"span\",\"to\":\"/\"}},[_c('van-icon',{attrs:{\"name\":\"arrow-left\",\"size\":\"25\",\"color\":\"#FFFFFF\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <router-link tag=\"span\" to=\"/\">\n    <van-icon name=\"arrow-left\" size=\"25\" color=\"#FFFFFF\" />\n  </router-link>\n</template>\n\n<script>\nexport default {\n  name: \"Back\"\n};\n</script>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Back.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Back.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Back.vue?vue&type=template&id=58183bbc&\"\nimport script from \"./Back.vue?vue&type=script&lang=js&\"\nexport * from \"./Back.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"control-wrapper\"},[_c('div',{staticClass:\"control-left\"},[_c('div',{staticClass:\"play-wrap\",on:{\"click\":_vm.handlePlayClick}},[_c('span',{staticClass:\"play-icon\",class:{ active: _vm.playState }})])]),_c('div',{staticClass:\"control-right\"},[_c('ul',{staticClass:\"btn-group\"},[_c('li',{staticClass:\"item full-screen-wrap\"},[_c('span',{staticClass:\"full-screen-icon\",class:{ active: _vm.screenStatus },on:{\"click\":_vm.handleFullScreenClick}})]),_c('li',{staticClass:\"item barrage-wrap\"},[_c('van-switch',{staticClass:\"barrage-btn\",attrs:{\"size\":\"0.53333rem\",\"active-color\":\"#2196F3\",\"inactive-color\":\"#999999\"},on:{\"change\":_vm.onChange},model:{value:(_vm.checked),callback:function ($$v) {_vm.checked=$$v},expression:\"checked\"}})],1)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"control-wrapper\">\n    <div class=\"control-left\">\n      <div class=\"play-wrap\" @click=\"handlePlayClick\">\n        <span class=\"play-icon\" :class=\"{ active: playState }\"></span>\n      </div>\n    </div>\n    <div class=\"control-right\">\n      <ul class=\"btn-group\">\n        <li class=\"item full-screen-wrap\">\n          <span\n            class=\"full-screen-icon\"\n            :class=\"{ active: screenStatus }\"\n            @click=\"handleFullScreenClick\"\n          ></span>\n        </li>\n        <li class=\"item barrage-wrap\">\n          <van-switch\n            class=\"barrage-btn\"\n            v-model=\"checked\"\n            @change=\"onChange\"\n            size=\"0.53333rem\"\n            active-color=\"#2196F3\"\n            inactive-color=\"#999999\"\n          />\n        </li>\n      </ul>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"Control\",\n  props: {\n    playState: {\n      type: Boolean,\n      default: false\n    },\n    screenStatus: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      checked: false\n    };\n  },\n  methods: {\n    handlePlayClick() {\n      this.$emit(\"toggleplay\");\n    },\n    handleFullScreenClick() {\n      this.$emit(\"fullscreenclick\");\n    },\n    onChange(checked) {\n      this.$emit(\"change\", checked);\n    }\n  }\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n@import \"~styles/mixins.styl\"\n\n.control-wrapper\n  height 77px\n  background rgba(5, 0, 1, 0.62)\n  padding-left 26px\n  padding-right 44px\n  box-sizing border-box\n  .control-left\n    height 100%\n    float left\n    .play-wrap\n      width-height-same(40px)\n      vertical(40px)\n      .play-icon\n        bg-image('play', 40)\n      .active\n        active-image('pause')\n  .control-right\n    height 100%\n    float right\n    .btn-group\n      vertical(40px)\n      .item\n        float right\n        margin-left 47px\n      .item:last-child\n        margin-left 0\n      .item:last-child:after\n        content ''\n        clear both\n      .barrage-wrap\n        height 40px\n        .barrage-btn\n          border none\n      .barrage-wrap:before\n        content '弹幕'\n        line-height 40px\n        height 100%\n        float left\n        baseTextStyle(26px, #D8D8D8, normal, Adobe Heiti Std)\n        margin-right 18px\n      .full-screen-wrap\n        width-height-same(40px)\n        .full-screen-icon\n          bg-image('full-screen', 40)\n        .active\n          active-image('small-screen')\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Control.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Control.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Control.vue?vue&type=template&id=c53d83c6&scoped=true&\"\nimport script from \"./Control.vue?vue&type=script&lang=js&\"\nexport * from \"./Control.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Control.vue?vue&type=style&index=0&id=c53d83c6&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c53d83c6\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ul',{staticClass:\"button-group-wrapper\"},[_vm._m(0),_c('li',{staticClass:\"item switch-btn-wrap\",on:{\"click\":_vm.handlSwitchClick}},[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.hideSwitchBtn),expression:\"hideSwitchBtn\"}],staticClass:\"switch-btn-icon\",class:{ 'switch-active': !_vm.isSubShow }})])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('li',{staticClass:\"item share-btn-wrap\"},[_c('span',{staticClass:\"share-btn-icon\"})])}]\n\nexport { render, staticRenderFns }","<template>\n  <ul class=\"button-group-wrapper\">\n    <li class=\"item share-btn-wrap\">\n      <span class=\"share-btn-icon\"></span>\n    </li>\n    <li class=\"item switch-btn-wrap\" @click=\"handlSwitchClick\">\n      <span\n        class=\"switch-btn-icon\"\n        :class=\"{ 'switch-active': !isSubShow }\"\n        v-show=\"hideSwitchBtn\"\n      ></span>\n    </li>\n  </ul>\n</template>\n\n<script>\nexport default {\n  name: \"ButtonGroup\",\n  props: {\n    isSubShow: {\n      type: Boolean,\n      default: true\n    },\n    hideSwitchBtn: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data() {\n    return {\n      toggle: true\n    };\n  },\n  methods: {\n    handlSwitchClick() {\n      const show = this.isSubShow;\n      if (show) {\n        this.switchWindows();\n      } else {\n        this.openSubWindows();\n      }\n    },\n    switchWindows() {\n      this.toggle = !this.toggle;\n      this.$emit(\"switch\", this.toggle);\n    },\n    openSubWindows() {\n      this.$emit(\"open\");\n    }\n  }\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n@import \"~styles/mixins.styl\"\n\n.button-group-wrapper\n  .item\n    margin-bottom 20px\n    .share-btn-icon\n      bg-image('share')\n    .switch-btn-icon\n      bg-image('switch')\n    .switch-active\n      /*active-image('open-windows')*/\n      display inline-block\n      width-height-same(70)\n      background-image none\n      border-radius 35px\n      background-color rgba(0, 0, 0, 0.62)\n      text-align center\n    .switch-active:after\n      content '双屏'\n      baseTextStyle(18px,$fff)\n      line-height 70px\n  .item:last-child\n    margin-bottom 0\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ButtonGroup.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ButtonGroup.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ButtonGroup.vue?vue&type=template&id=21156dbc&scoped=true&\"\nimport script from \"./ButtonGroup.vue?vue&type=script&lang=js&\"\nexport * from \"./ButtonGroup.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ButtonGroup.vue?vue&type=style&index=0&id=21156dbc&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"21156dbc\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{attrs:{\"id\":\"cvs\"}},[_vm._v(\"您浏览器不支持canvas，建议使用google浏览器\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// 弹幕库实例\r\nvar Danmaku = /** @class */ (function () {\r\n    function Danmaku(canvas, danmakuConfig) {\r\n        this.isPause = false;\r\n        this.lastRenderTime = 0;\r\n        this.mDanmuTracks = new Array();\r\n        this.mCanvas = canvas;\r\n        this.mDanmukuConfig = danmakuConfig;\r\n        this.mCtx = canvas.getContext('2d');\r\n        this.initRender();\r\n    }\r\n    Danmaku.prototype.addDanmuTrack = function (danmuTrack) {\r\n        this.mDanmuTracks.push(danmuTrack);\r\n        danmuTrack.setDanmaku(this);\r\n    };\r\n    Danmaku.prototype.removeDanmuTrack = function (danmuTrack) {\r\n        this.mDanmuTracks = this.mDanmuTracks.filter(function (item) { return item !== danmuTrack; });\r\n    };\r\n    Danmaku.prototype.initRender = function () {\r\n        this.mCanvas.width = this.mDanmukuConfig.width;\r\n        this.mCanvas.height = this.mDanmukuConfig.height;\r\n        if (window.requestAnimationFrame) {\r\n            this.renderByAnimationFrame();\r\n        }\r\n        else {\r\n            this.renderBySetInterval();\r\n        }\r\n    };\r\n    Danmaku.prototype.renderByAnimationFrame = function () {\r\n        this.render();\r\n        requestAnimationFrame(this.renderByAnimationFrame.bind(this));\r\n    };\r\n    Danmaku.prototype.renderBySetInterval = function () {\r\n        setInterval(this.render.bind(this), 0);\r\n    };\r\n    Danmaku.prototype.render = function () {\r\n        if (this.isPause)\r\n            return;\r\n        // let currentTime = new Date().getTime()\r\n        // if (currentTime - this.lastRenderTime < 8) {\r\n        //  return\r\n        // }\r\n        // this.lastRenderTime = currentTime\r\n        this.mCtx.clearRect(0, 0, this.mCanvas.width, this.mCanvas.height);\r\n        for (var _i = 0, _a = this.mDanmuTracks; _i < _a.length; _i++) {\r\n            var mDanmuTrack = _a[_i];\r\n            mDanmuTrack.render(this.mCtx);\r\n        }\r\n    };\r\n    Danmaku.prototype.start = function () {\r\n        this.isPause = false;\r\n    };\r\n    Danmaku.prototype.pause = function () {\r\n        this.isPause = true;\r\n    };\r\n    return Danmaku;\r\n}());\n\nvar DanmakuPool = /** @class */ (function () {\r\n    function DanmakuPool(size) {\r\n        this.mPoolSize = 20;\r\n        this.mMessagePool = new Array(this.mPoolSize);\r\n        if (size) {\r\n            this.mPoolSize = size;\r\n            this.mMessagePool = new Array(this.mPoolSize);\r\n        }\r\n    }\r\n    DanmakuPool.prototype.addMessage = function (msg) {\r\n        this.addMessages([msg]);\r\n    };\r\n    DanmakuPool.prototype.getMessage = function () {\r\n        var result = null;\r\n        for (var i = 0; i < this.mMessagePool.length; i++) {\r\n            if (this.mMessagePool[i] && this.mMessagePool[i].created) {\r\n                result = this.mMessagePool[i];\r\n                this.mMessagePool[i] = null;\r\n                break;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DanmakuPool.prototype.addMessages = function (msgs) {\r\n        if (msgs === void 0) { msgs = []; }\r\n        for (var i = 0; i < msgs.length; i++) {\r\n            for (var j = 0; j < this.mMessagePool.length; j++) {\r\n                if (!this.mMessagePool[j]) {\r\n                    this.mMessagePool[j] = msgs[i];\r\n                    if (this.mMessagePool[j])\r\n                        this.mMessagePool[j].onBaseCreate();\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DanmakuPool.prototype.removeMessage = function (msg) {\r\n        var index = this.mMessagePool.findIndex(function (item) { return item === msg; });\r\n        this.removeMessageByIndex(index);\r\n    };\r\n    DanmakuPool.prototype.removeMessageByIndex = function (index) {\r\n        if (Number.isInteger(index) && index > 0) {\r\n            this.mMessagePool[index] = null;\r\n        }\r\n    };\r\n    return DanmakuPool;\r\n}());\n\nvar DanmaTrack = /** @class */ (function () {\r\n    function DanmaTrack(danmuPool, danmaTrackConfig) {\r\n        this.mDanmaMessages = new Array();\r\n        this.mTrackInfo = {\r\n            maxWidth: 0,\r\n            top: 0,\r\n            height: 0\r\n        };\r\n        this.mDanmuTrackConfig = {\r\n            top: 0,\r\n            height: 0\r\n        };\r\n        this.mDanmuPool = danmuPool;\r\n        this.initConfig(danmaTrackConfig);\r\n    }\r\n    DanmaTrack.prototype.setDanmaku = function (danmaku) {\r\n        this.mDanmaku = danmaku;\r\n    };\r\n    DanmaTrack.prototype.initConfig = function (danmaTrackConfig) {\r\n        this.mDanmuTrackConfig = danmaTrackConfig;\r\n        this.mTrackInfo.top = danmaTrackConfig.top;\r\n        this.mTrackInfo.height = danmaTrackConfig.height;\r\n    };\r\n    DanmaTrack.prototype.render = function (ctx) {\r\n        this.refreshMessage(ctx);\r\n        for (var i = 0; i < this.mDanmaMessages.length; i++) {\r\n            var currentDanmaMessage = this.mDanmaMessages[i];\r\n            currentDanmaMessage.onBaseMeasure(ctx, this.mTrackInfo);\r\n            currentDanmaMessage.onBaseLayout(ctx, this.mTrackInfo);\r\n            currentDanmaMessage.onBaseDraw(ctx, this.mTrackInfo);\r\n            currentDanmaMessage.onBaseDestroyed();\r\n            if (i === this.mDanmaMessages.length - 1) {\r\n                this.mTrackInfo.maxWidth =\r\n                    currentDanmaMessage.position.left + currentDanmaMessage.size.width;\r\n            }\r\n        }\r\n    };\r\n    DanmaTrack.prototype.refreshMessage = function (ctx) {\r\n        this.removeMessage();\r\n        this.AddMessage(ctx);\r\n    };\r\n    DanmaTrack.prototype.AddMessage = function (ctx) {\r\n        if (this.mTrackInfo.maxWidth < ctx.canvas.width - 10) {\r\n            var msg = this.mDanmuPool.getMessage();\r\n            if (msg) {\r\n                console.log(msg);\r\n                this.mDanmaMessages.push(msg);\r\n            }\r\n        }\r\n    };\r\n    DanmaTrack.prototype.removeMessage = function () {\r\n        this.mDanmaMessages = this.mDanmaMessages.filter(function (item) { return !item.distoryed; });\r\n    };\r\n    return DanmaTrack;\r\n}());\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\n\nvar BaseMessage = /** @class */ (function () {\r\n    function BaseMessage() {\r\n        this.created = false;\r\n        this.distoryed = false;\r\n        this.isLayout = false;\r\n        this.position = {\r\n            top: 0,\r\n            left: 0\r\n        };\r\n        this.size = {\r\n            width: 0,\r\n            height: 0\r\n        };\r\n    }\r\n    BaseMessage.prototype.onBaseCreate = function () {\r\n        var _this = this;\r\n        this.onCreate(function (val) {\r\n            if (val) {\r\n                _this.created = true;\r\n            }\r\n            else {\r\n                _this.distoryed = true;\r\n            }\r\n        });\r\n    };\r\n    BaseMessage.prototype.onBaseDestroyed = function () {\r\n        this.distoryed = this.onDestroyed();\r\n    };\r\n    BaseMessage.prototype.onBaseMeasure = function (ctx, trackInfo) {\r\n        this.size = this.onMeasure(ctx, trackInfo);\r\n    };\r\n    BaseMessage.prototype.onBaseLayout = function (ctx, trackInfo) {\r\n        this.position = this.onLayout(ctx, trackInfo);\r\n    };\r\n    BaseMessage.prototype.onBaseDraw = function (ctx, trackInfo) {\r\n        this.onDraw(ctx, trackInfo);\r\n    };\r\n    return BaseMessage;\r\n}());\n\nvar TextMessage = /** @class */ (function (_super) {\r\n    __extends(TextMessage, _super);\r\n    function TextMessage(msg) {\r\n        var _this = _super.call(this) || this;\r\n        _this.textMessageConfig = {\r\n            mMsg: '',\r\n            color: '#FFF',\r\n            strokeColor: '#000',\r\n            fontSize: 30,\r\n            fontFamily: '黑体'\r\n        };\r\n        _this.textMessageConfig = Object.assign({}, _this.textMessageConfig, msg);\r\n        return _this;\r\n    }\r\n    TextMessage.prototype.onCreate = function (callback) {\r\n        callback(true);\r\n    };\r\n    TextMessage.prototype.onMeasure = function (ctx, trackInfo) {\r\n        ctx.textAlign = 'left';\r\n        ctx.textBaseline = 'middle';\r\n        ctx.font = this.textMessageConfig.fontSize + \"px \" + this.textMessageConfig.fontFamily;\r\n        var res = ctx.measureText(this.textMessageConfig.mMsg);\r\n        return {\r\n            width: res.width,\r\n            height: trackInfo.height\r\n        };\r\n    };\r\n    TextMessage.prototype.onLayout = function (ctx, trackInfo) {\r\n        if (!this.isLayout) {\r\n            this.isLayout = true;\r\n            return {\r\n                top: trackInfo.top + trackInfo.height / 2,\r\n                left: ctx.canvas.width\r\n            };\r\n        }\r\n        this.position.left -= 3;\r\n        return this.position;\r\n    };\r\n    TextMessage.prototype.onDraw = function (ctx, trackInfo) {\r\n        ctx.fillStyle = this.textMessageConfig.strokeColor;\r\n        ctx.strokeText(this.textMessageConfig.mMsg, this.position.left, this.position.top);\r\n        ctx.fillStyle = this.textMessageConfig.color;\r\n        ctx.fillText(this.textMessageConfig.mMsg, this.position.left, this.position.top);\r\n    };\r\n    TextMessage.prototype.onDestroyed = function () {\r\n        return this.position.left < -this.size.width;\r\n    };\r\n    return TextMessage;\r\n}(BaseMessage));\n\nvar ImgMessage = /** @class */ (function (_super) {\r\n    __extends(ImgMessage, _super);\r\n    function ImgMessage(msg) {\r\n        var _this = _super.call(this) || this;\r\n        _this.ImgMessageConfig = {\r\n            url: '',\r\n            width: 0,\r\n            height: 0\r\n        };\r\n        _this.mImg = new Image();\r\n        _this.ImgMessageConfig = Object.assign({}, _this.ImgMessageConfig, msg);\r\n        return _this;\r\n    }\r\n    ImgMessage.prototype.onCreate = function (callback) {\r\n        var _this = this;\r\n        this.mImg.onload = function () {\r\n            _this.ImgMessageConfig.width = _this.ImgMessageConfig.width || _this.mImg.width || 300;\r\n            _this.ImgMessageConfig.height = _this.ImgMessageConfig.height || _this.mImg.height || 200;\r\n            callback(true);\r\n        };\r\n        this.mImg.onerror = function () {\r\n            document.body.removeChild(_this.mImg);\r\n            callback(false);\r\n        };\r\n        this.mImg.src = this.ImgMessageConfig.url;\r\n        this.mImg.style.position = 'fixed';\r\n        this.mImg.style.top = '-1000px';\r\n        this.mImg.style.left = '-1000px';\r\n        document.body.appendChild(this.mImg);\r\n    };\r\n    ImgMessage.prototype.onMeasure = function (ctx, trackInfo) {\r\n        return {\r\n            width: this.ImgMessageConfig.width,\r\n            height: this.ImgMessageConfig.height\r\n        };\r\n    };\r\n    ImgMessage.prototype.onLayout = function (ctx, trackInfo) {\r\n        if (!this.isLayout) {\r\n            this.isLayout = true;\r\n            return {\r\n                top: trackInfo.top,\r\n                left: ctx.canvas.width\r\n            };\r\n        }\r\n        this.position.left -= 3;\r\n        return this.position;\r\n    };\r\n    ImgMessage.prototype.onDraw = function (ctx, trackInfo) {\r\n        ctx.drawImage(this.mImg, this.position.left, this.position.top, this.size.width, this.size.height);\r\n    };\r\n    ImgMessage.prototype.onDestroyed = function () {\r\n        var result = this.position.left < -this.size.width;\r\n        if (result) {\r\n            document.body.removeChild(this.mImg);\r\n        }\r\n        return result;\r\n    };\r\n    return ImgMessage;\r\n}(BaseMessage));\n\nfunction ajax(para) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var tmp, response, e_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    _a.trys.push([0, 3, , 4]);\r\n                    return [4 /*yield*/, fetch(para.url)];\r\n                case 1:\r\n                    tmp = _a.sent();\r\n                    return [4 /*yield*/, tmp.arrayBuffer()];\r\n                case 2:\r\n                    response = _a.sent();\r\n                    para.callback(null, response);\r\n                    return [3 /*break*/, 4];\r\n                case 3:\r\n                    e_1 = _a.sent();\r\n                    para.callback(e_1, new ArrayBuffer(0));\r\n                    return [3 /*break*/, 4];\r\n                case 4: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar omggif = createCommonjsModule(function (module, exports) {\n\nfunction GifWriter(buf, width, height, gopts) {\n  var p = 0;\n\n  var gopts = gopts === undefined ? { } : gopts;\n  var loop_count = gopts.loop === undefined ? null : gopts.loop;\n  var global_palette = gopts.palette === undefined ? null : gopts.palette;\n\n  if (width <= 0 || height <= 0 || width > 65535 || height > 65535)\n    throw new Error(\"Width/Height invalid.\");\n\n  function check_palette_and_num_colors(palette) {\n    var num_colors = palette.length;\n    if (num_colors < 2 || num_colors > 256 ||  num_colors & (num_colors-1)) {\n      throw new Error(\n          \"Invalid code/color length, must be power of 2 and 2 .. 256.\");\n    }\n    return num_colors;\n  }\n\n  // - Header.\n  buf[p++] = 0x47; buf[p++] = 0x49; buf[p++] = 0x46;  // GIF\n  buf[p++] = 0x38; buf[p++] = 0x39; buf[p++] = 0x61;  // 89a\n\n  // Handling of Global Color Table (palette) and background index.\n  var gp_num_colors_pow2 = 0;\n  var background = 0;\n  if (global_palette !== null) {\n    var gp_num_colors = check_palette_and_num_colors(global_palette);\n    while (gp_num_colors >>= 1) ++gp_num_colors_pow2;\n    gp_num_colors = 1 << gp_num_colors_pow2;\n    --gp_num_colors_pow2;\n    if (gopts.background !== undefined) {\n      background = gopts.background;\n      if (background >= gp_num_colors)\n        throw new Error(\"Background index out of range.\");\n      // The GIF spec states that a background index of 0 should be ignored, so\n      // this is probably a mistake and you really want to set it to another\n      // slot in the palette.  But actually in the end most browsers, etc end\n      // up ignoring this almost completely (including for dispose background).\n      if (background === 0)\n        throw new Error(\"Background index explicitly passed as 0.\");\n    }\n  }\n\n  // - Logical Screen Descriptor.\n  // NOTE(deanm): w/h apparently ignored by implementations, but set anyway.\n  buf[p++] = width & 0xff; buf[p++] = width >> 8 & 0xff;\n  buf[p++] = height & 0xff; buf[p++] = height >> 8 & 0xff;\n  // NOTE: Indicates 0-bpp original color resolution (unused?).\n  buf[p++] = (global_palette !== null ? 0x80 : 0) |  // Global Color Table Flag.\n             gp_num_colors_pow2;  // NOTE: No sort flag (unused?).\n  buf[p++] = background;  // Background Color Index.\n  buf[p++] = 0;  // Pixel aspect ratio (unused?).\n\n  // - Global Color Table\n  if (global_palette !== null) {\n    for (var i = 0, il = global_palette.length; i < il; ++i) {\n      var rgb = global_palette[i];\n      buf[p++] = rgb >> 16 & 0xff;\n      buf[p++] = rgb >> 8 & 0xff;\n      buf[p++] = rgb & 0xff;\n    }\n  }\n\n  if (loop_count !== null) {  // Netscape block for looping.\n    if (loop_count < 0 || loop_count > 65535)\n      throw new Error(\"Loop count invalid.\")\n    // Extension code, label, and length.\n    buf[p++] = 0x21; buf[p++] = 0xff; buf[p++] = 0x0b;\n    // NETSCAPE2.0\n    buf[p++] = 0x4e; buf[p++] = 0x45; buf[p++] = 0x54; buf[p++] = 0x53;\n    buf[p++] = 0x43; buf[p++] = 0x41; buf[p++] = 0x50; buf[p++] = 0x45;\n    buf[p++] = 0x32; buf[p++] = 0x2e; buf[p++] = 0x30;\n    // Sub-block\n    buf[p++] = 0x03; buf[p++] = 0x01;\n    buf[p++] = loop_count & 0xff; buf[p++] = loop_count >> 8 & 0xff;\n    buf[p++] = 0x00;  // Terminator.\n  }\n\n\n  var ended = false;\n\n  this.addFrame = function(x, y, w, h, indexed_pixels, opts) {\n    if (ended === true) { --p; ended = false; }  // Un-end.\n\n    opts = opts === undefined ? { } : opts;\n\n    // TODO(deanm): Bounds check x, y.  Do they need to be within the virtual\n    // canvas width/height, I imagine?\n    if (x < 0 || y < 0 || x > 65535 || y > 65535)\n      throw new Error(\"x/y invalid.\")\n\n    if (w <= 0 || h <= 0 || w > 65535 || h > 65535)\n      throw new Error(\"Width/Height invalid.\")\n\n    if (indexed_pixels.length < w * h)\n      throw new Error(\"Not enough pixels for the frame size.\");\n\n    var using_local_palette = true;\n    var palette = opts.palette;\n    if (palette === undefined || palette === null) {\n      using_local_palette = false;\n      palette = global_palette;\n    }\n\n    if (palette === undefined || palette === null)\n      throw new Error(\"Must supply either a local or global palette.\");\n\n    var num_colors = check_palette_and_num_colors(palette);\n\n    // Compute the min_code_size (power of 2), destroying num_colors.\n    var min_code_size = 0;\n    while (num_colors >>= 1) ++min_code_size;\n    num_colors = 1 << min_code_size;  // Now we can easily get it back.\n\n    var delay = opts.delay === undefined ? 0 : opts.delay;\n\n    // From the spec:\n    //     0 -   No disposal specified. The decoder is\n    //           not required to take any action.\n    //     1 -   Do not dispose. The graphic is to be left\n    //           in place.\n    //     2 -   Restore to background color. The area used by the\n    //           graphic must be restored to the background color.\n    //     3 -   Restore to previous. The decoder is required to\n    //           restore the area overwritten by the graphic with\n    //           what was there prior to rendering the graphic.\n    //  4-7 -    To be defined.\n    // NOTE(deanm): Dispose background doesn't really work, apparently most\n    // browsers ignore the background palette index and clear to transparency.\n    var disposal = opts.disposal === undefined ? 0 : opts.disposal;\n    if (disposal < 0 || disposal > 3)  // 4-7 is reserved.\n      throw new Error(\"Disposal out of range.\");\n\n    var use_transparency = false;\n    var transparent_index = 0;\n    if (opts.transparent !== undefined && opts.transparent !== null) {\n      use_transparency = true;\n      transparent_index = opts.transparent;\n      if (transparent_index < 0 || transparent_index >= num_colors)\n        throw new Error(\"Transparent color index.\");\n    }\n\n    if (disposal !== 0 || use_transparency || delay !== 0) {\n      // - Graphics Control Extension\n      buf[p++] = 0x21; buf[p++] = 0xf9;  // Extension / Label.\n      buf[p++] = 4;  // Byte size.\n\n      buf[p++] = disposal << 2 | (use_transparency === true ? 1 : 0);\n      buf[p++] = delay & 0xff; buf[p++] = delay >> 8 & 0xff;\n      buf[p++] = transparent_index;  // Transparent color index.\n      buf[p++] = 0;  // Block Terminator.\n    }\n\n    // - Image Descriptor\n    buf[p++] = 0x2c;  // Image Seperator.\n    buf[p++] = x & 0xff; buf[p++] = x >> 8 & 0xff;  // Left.\n    buf[p++] = y & 0xff; buf[p++] = y >> 8 & 0xff;  // Top.\n    buf[p++] = w & 0xff; buf[p++] = w >> 8 & 0xff;\n    buf[p++] = h & 0xff; buf[p++] = h >> 8 & 0xff;\n    // NOTE: No sort flag (unused?).\n    // TODO(deanm): Support interlace.\n    buf[p++] = using_local_palette === true ? (0x80 | (min_code_size-1)) : 0;\n\n    // - Local Color Table\n    if (using_local_palette === true) {\n      for (var i = 0, il = palette.length; i < il; ++i) {\n        var rgb = palette[i];\n        buf[p++] = rgb >> 16 & 0xff;\n        buf[p++] = rgb >> 8 & 0xff;\n        buf[p++] = rgb & 0xff;\n      }\n    }\n\n    p = GifWriterOutputLZWCodeStream(\n            buf, p, min_code_size < 2 ? 2 : min_code_size, indexed_pixels);\n\n    return p;\n  };\n\n  this.end = function() {\n    if (ended === false) {\n      buf[p++] = 0x3b;  // Trailer.\n      ended = true;\n    }\n    return p;\n  };\n\n  this.getOutputBuffer = function() { return buf; };\n  this.setOutputBuffer = function(v) { buf = v; };\n  this.getOutputBufferPosition = function() { return p; };\n  this.setOutputBufferPosition = function(v) { p = v; };\n}\n\n// Main compression routine, palette indexes -> LZW code stream.\n// |index_stream| must have at least one entry.\nfunction GifWriterOutputLZWCodeStream(buf, p, min_code_size, index_stream) {\n  buf[p++] = min_code_size;\n  var cur_subblock = p++;  // Pointing at the length field.\n\n  var clear_code = 1 << min_code_size;\n  var code_mask = clear_code - 1;\n  var eoi_code = clear_code + 1;\n  var next_code = eoi_code + 1;\n\n  var cur_code_size = min_code_size + 1;  // Number of bits per code.\n  var cur_shift = 0;\n  // We have at most 12-bit codes, so we should have to hold a max of 19\n  // bits here (and then we would write out).\n  var cur = 0;\n\n  function emit_bytes_to_buffer(bit_block_size) {\n    while (cur_shift >= bit_block_size) {\n      buf[p++] = cur & 0xff;\n      cur >>= 8; cur_shift -= 8;\n      if (p === cur_subblock + 256) {  // Finished a subblock.\n        buf[cur_subblock] = 255;\n        cur_subblock = p++;\n      }\n    }\n  }\n\n  function emit_code(c) {\n    cur |= c << cur_shift;\n    cur_shift += cur_code_size;\n    emit_bytes_to_buffer(8);\n  }\n\n  // I am not an expert on the topic, and I don't want to write a thesis.\n  // However, it is good to outline here the basic algorithm and the few data\n  // structures and optimizations here that make this implementation fast.\n  // The basic idea behind LZW is to build a table of previously seen runs\n  // addressed by a short id (herein called output code).  All data is\n  // referenced by a code, which represents one or more values from the\n  // original input stream.  All input bytes can be referenced as the same\n  // value as an output code.  So if you didn't want any compression, you\n  // could more or less just output the original bytes as codes (there are\n  // some details to this, but it is the idea).  In order to achieve\n  // compression, values greater then the input range (codes can be up to\n  // 12-bit while input only 8-bit) represent a sequence of previously seen\n  // inputs.  The decompressor is able to build the same mapping while\n  // decoding, so there is always a shared common knowledge between the\n  // encoding and decoder, which is also important for \"timing\" aspects like\n  // how to handle variable bit width code encoding.\n  //\n  // One obvious but very important consequence of the table system is there\n  // is always a unique id (at most 12-bits) to map the runs.  'A' might be\n  // 4, then 'AA' might be 10, 'AAA' 11, 'AAAA' 12, etc.  This relationship\n  // can be used for an effecient lookup strategy for the code mapping.  We\n  // need to know if a run has been seen before, and be able to map that run\n  // to the output code.  Since we start with known unique ids (input bytes),\n  // and then from those build more unique ids (table entries), we can\n  // continue this chain (almost like a linked list) to always have small\n  // integer values that represent the current byte chains in the encoder.\n  // This means instead of tracking the input bytes (AAAABCD) to know our\n  // current state, we can track the table entry for AAAABC (it is guaranteed\n  // to exist by the nature of the algorithm) and the next character D.\n  // Therefor the tuple of (table_entry, byte) is guaranteed to also be\n  // unique.  This allows us to create a simple lookup key for mapping input\n  // sequences to codes (table indices) without having to store or search\n  // any of the code sequences.  So if 'AAAA' has a table entry of 12, the\n  // tuple of ('AAAA', K) for any input byte K will be unique, and can be our\n  // key.  This leads to a integer value at most 20-bits, which can always\n  // fit in an SMI value and be used as a fast sparse array / object key.\n\n  // Output code for the current contents of the index buffer.\n  var ib_code = index_stream[0] & code_mask;  // Load first input index.\n  var code_table = { };  // Key'd on our 20-bit \"tuple\".\n\n  emit_code(clear_code);  // Spec says first code should be a clear code.\n\n  // First index already loaded, process the rest of the stream.\n  for (var i = 1, il = index_stream.length; i < il; ++i) {\n    var k = index_stream[i] & code_mask;\n    var cur_key = ib_code << 8 | k;  // (prev, k) unique tuple.\n    var cur_code = code_table[cur_key];  // buffer + k.\n\n    // Check if we have to create a new code table entry.\n    if (cur_code === undefined) {  // We don't have buffer + k.\n      // Emit index buffer (without k).\n      // This is an inline version of emit_code, because this is the core\n      // writing routine of the compressor (and V8 cannot inline emit_code\n      // because it is a closure here in a different context).  Additionally\n      // we can call emit_byte_to_buffer less often, because we can have\n      // 30-bits (from our 31-bit signed SMI), and we know our codes will only\n      // be 12-bits, so can safely have 18-bits there without overflow.\n      // emit_code(ib_code);\n      cur |= ib_code << cur_shift;\n      cur_shift += cur_code_size;\n      while (cur_shift >= 8) {\n        buf[p++] = cur & 0xff;\n        cur >>= 8; cur_shift -= 8;\n        if (p === cur_subblock + 256) {  // Finished a subblock.\n          buf[cur_subblock] = 255;\n          cur_subblock = p++;\n        }\n      }\n\n      if (next_code === 4096) {  // Table full, need a clear.\n        emit_code(clear_code);\n        next_code = eoi_code + 1;\n        cur_code_size = min_code_size + 1;\n        code_table = { };\n      } else {  // Table not full, insert a new entry.\n        // Increase our variable bit code sizes if necessary.  This is a bit\n        // tricky as it is based on \"timing\" between the encoding and\n        // decoder.  From the encoders perspective this should happen after\n        // we've already emitted the index buffer and are about to create the\n        // first table entry that would overflow our current code bit size.\n        if (next_code >= (1 << cur_code_size)) ++cur_code_size;\n        code_table[cur_key] = next_code++;  // Insert into code table.\n      }\n\n      ib_code = k;  // Index buffer to single input k.\n    } else {\n      ib_code = cur_code;  // Index buffer to sequence in code table.\n    }\n  }\n\n  emit_code(ib_code);  // There will still be something in the index buffer.\n  emit_code(eoi_code);  // End Of Information.\n\n  // Flush / finalize the sub-blocks stream to the buffer.\n  emit_bytes_to_buffer(1);\n\n  // Finish the sub-blocks, writing out any unfinished lengths and\n  // terminating with a sub-block of length 0.  If we have already started\n  // but not yet used a sub-block it can just become the terminator.\n  if (cur_subblock + 1 === p) {  // Started but unused.\n    buf[cur_subblock] = 0;\n  } else {  // Started and used, write length and additional terminator block.\n    buf[cur_subblock] = p - cur_subblock - 1;\n    buf[p++] = 0;\n  }\n  return p;\n}\n\nfunction GifReader(buf) {\n  var p = 0;\n\n  // - Header (GIF87a or GIF89a).\n  if (buf[p++] !== 0x47 ||            buf[p++] !== 0x49 || buf[p++] !== 0x46 ||\n      buf[p++] !== 0x38 || (buf[p++]+1 & 0xfd) !== 0x38 || buf[p++] !== 0x61) {\n    throw new Error(\"Invalid GIF 87a/89a header.\");\n  }\n\n  // - Logical Screen Descriptor.\n  var width = buf[p++] | buf[p++] << 8;\n  var height = buf[p++] | buf[p++] << 8;\n  var pf0 = buf[p++];  // <Packed Fields>.\n  var global_palette_flag = pf0 >> 7;\n  var num_global_colors_pow2 = pf0 & 0x7;\n  var num_global_colors = 1 << (num_global_colors_pow2 + 1);\n  var background = buf[p++];\n  buf[p++];  // Pixel aspect ratio (unused?).\n\n  var global_palette_offset = null;\n  var global_palette_size   = null;\n\n  if (global_palette_flag) {\n    global_palette_offset = p;\n    global_palette_size = num_global_colors;\n    p += num_global_colors * 3;  // Seek past palette.\n  }\n\n  var no_eof = true;\n\n  var frames = [ ];\n\n  var delay = 0;\n  var transparent_index = null;\n  var disposal = 0;  // 0 - No disposal specified.\n  var loop_count = null;\n\n  this.width = width;\n  this.height = height;\n\n  while (no_eof && p < buf.length) {\n    switch (buf[p++]) {\n      case 0x21:  // Graphics Control Extension Block\n        switch (buf[p++]) {\n          case 0xff:  // Application specific block\n            // Try if it's a Netscape block (with animation loop counter).\n            if (buf[p   ] !== 0x0b ||  // 21 FF already read, check block size.\n                // NETSCAPE2.0\n                buf[p+1 ] == 0x4e && buf[p+2 ] == 0x45 && buf[p+3 ] == 0x54 &&\n                buf[p+4 ] == 0x53 && buf[p+5 ] == 0x43 && buf[p+6 ] == 0x41 &&\n                buf[p+7 ] == 0x50 && buf[p+8 ] == 0x45 && buf[p+9 ] == 0x32 &&\n                buf[p+10] == 0x2e && buf[p+11] == 0x30 &&\n                // Sub-block\n                buf[p+12] == 0x03 && buf[p+13] == 0x01 && buf[p+16] == 0) {\n              p += 14;\n              loop_count = buf[p++] | buf[p++] << 8;\n              p++;  // Skip terminator.\n            } else {  // We don't know what it is, just try to get past it.\n              p += 12;\n              while (true) {  // Seek through subblocks.\n                var block_size = buf[p++];\n                // Bad block size (ex: undefined from an out of bounds read).\n                if (!(block_size >= 0)) throw Error(\"Invalid block size\");\n                if (block_size === 0) break;  // 0 size is terminator\n                p += block_size;\n              }\n            }\n            break;\n\n          case 0xf9:  // Graphics Control Extension\n            if (buf[p++] !== 0x4 || buf[p+4] !== 0)\n              throw new Error(\"Invalid graphics extension block.\");\n            var pf1 = buf[p++];\n            delay = buf[p++] | buf[p++] << 8;\n            transparent_index = buf[p++];\n            if ((pf1 & 1) === 0) transparent_index = null;\n            disposal = pf1 >> 2 & 0x7;\n            p++;  // Skip terminator.\n            break;\n\n          case 0xfe:  // Comment Extension.\n            while (true) {  // Seek through subblocks.\n              var block_size = buf[p++];\n              // Bad block size (ex: undefined from an out of bounds read).\n              if (!(block_size >= 0)) throw Error(\"Invalid block size\");\n              if (block_size === 0) break;  // 0 size is terminator\n              // console.log(buf.slice(p, p+block_size).toString('ascii'));\n              p += block_size;\n            }\n            break;\n\n          default:\n            throw new Error(\n                \"Unknown graphic control label: 0x\" + buf[p-1].toString(16));\n        }\n        break;\n\n      case 0x2c:  // Image Descriptor.\n        var x = buf[p++] | buf[p++] << 8;\n        var y = buf[p++] | buf[p++] << 8;\n        var w = buf[p++] | buf[p++] << 8;\n        var h = buf[p++] | buf[p++] << 8;\n        var pf2 = buf[p++];\n        var local_palette_flag = pf2 >> 7;\n        var interlace_flag = pf2 >> 6 & 1;\n        var num_local_colors_pow2 = pf2 & 0x7;\n        var num_local_colors = 1 << (num_local_colors_pow2 + 1);\n        var palette_offset = global_palette_offset;\n        var palette_size = global_palette_size;\n        var has_local_palette = false;\n        if (local_palette_flag) {\n          var has_local_palette = true;\n          palette_offset = p;  // Override with local palette.\n          palette_size = num_local_colors;\n          p += num_local_colors * 3;  // Seek past palette.\n        }\n\n        var data_offset = p;\n\n        p++;  // codesize\n        while (true) {\n          var block_size = buf[p++];\n          // Bad block size (ex: undefined from an out of bounds read).\n          if (!(block_size >= 0)) throw Error(\"Invalid block size\");\n          if (block_size === 0) break;  // 0 size is terminator\n          p += block_size;\n        }\n\n        frames.push({x: x, y: y, width: w, height: h,\n                     has_local_palette: has_local_palette,\n                     palette_offset: palette_offset,\n                     palette_size: palette_size,\n                     data_offset: data_offset,\n                     data_length: p - data_offset,\n                     transparent_index: transparent_index,\n                     interlaced: !!interlace_flag,\n                     delay: delay,\n                     disposal: disposal});\n        break;\n\n      case 0x3b:  // Trailer Marker (end of file).\n        no_eof = false;\n        break;\n\n      default:\n        throw new Error(\"Unknown gif block: 0x\" + buf[p-1].toString(16));\n        break;\n    }\n  }\n\n  this.numFrames = function() {\n    return frames.length;\n  };\n\n  this.loopCount = function() {\n    return loop_count;\n  };\n\n  this.frameInfo = function(frame_num) {\n    if (frame_num < 0 || frame_num >= frames.length)\n      throw new Error(\"Frame index out of range.\");\n    return frames[frame_num];\n  };\n\n  this.decodeAndBlitFrameBGRA = function(frame_num, pixels) {\n    var frame = this.frameInfo(frame_num);\n    var num_pixels = frame.width * frame.height;\n    var index_stream = new Uint8Array(num_pixels);  // At most 8-bit indices.\n    GifReaderLZWOutputIndexStream(\n        buf, frame.data_offset, index_stream, num_pixels);\n    var palette_offset = frame.palette_offset;\n\n    // NOTE(deanm): It seems to be much faster to compare index to 256 than\n    // to === null.  Not sure why, but CompareStub_EQ_STRICT shows up high in\n    // the profile, not sure if it's related to using a Uint8Array.\n    var trans = frame.transparent_index;\n    if (trans === null) trans = 256;\n\n    // We are possibly just blitting to a portion of the entire frame.\n    // That is a subrect within the framerect, so the additional pixels\n    // must be skipped over after we finished a scanline.\n    var framewidth  = frame.width;\n    var framestride = width - framewidth;\n    var xleft       = framewidth;  // Number of subrect pixels left in scanline.\n\n    // Output indicies of the top left and bottom right corners of the subrect.\n    var opbeg = ((frame.y * width) + frame.x) * 4;\n    var opend = ((frame.y + frame.height) * width + frame.x) * 4;\n    var op    = opbeg;\n\n    var scanstride = framestride * 4;\n\n    // Use scanstride to skip past the rows when interlacing.  This is skipping\n    // 7 rows for the first two passes, then 3 then 1.\n    if (frame.interlaced === true) {\n      scanstride += width * 4 * 7;  // Pass 1.\n    }\n\n    var interlaceskip = 8;  // Tracking the row interval in the current pass.\n\n    for (var i = 0, il = index_stream.length; i < il; ++i) {\n      var index = index_stream[i];\n\n      if (xleft === 0) {  // Beginning of new scan line\n        op += scanstride;\n        xleft = framewidth;\n        if (op >= opend) { // Catch the wrap to switch passes when interlacing.\n          scanstride = framestride * 4 + width * 4 * (interlaceskip-1);\n          // interlaceskip / 2 * 4 is interlaceskip << 1.\n          op = opbeg + (framewidth + framestride) * (interlaceskip << 1);\n          interlaceskip >>= 1;\n        }\n      }\n\n      if (index === trans) {\n        op += 4;\n      } else {\n        var r = buf[palette_offset + index * 3];\n        var g = buf[palette_offset + index * 3 + 1];\n        var b = buf[palette_offset + index * 3 + 2];\n        pixels[op++] = b;\n        pixels[op++] = g;\n        pixels[op++] = r;\n        pixels[op++] = 255;\n      }\n      --xleft;\n    }\n  };\n\n  // I will go to copy and paste hell one day...\n  this.decodeAndBlitFrameRGBA = function(frame_num, pixels) {\n    var frame = this.frameInfo(frame_num);\n    var num_pixels = frame.width * frame.height;\n    var index_stream = new Uint8Array(num_pixels);  // At most 8-bit indices.\n    GifReaderLZWOutputIndexStream(\n        buf, frame.data_offset, index_stream, num_pixels);\n    var palette_offset = frame.palette_offset;\n\n    // NOTE(deanm): It seems to be much faster to compare index to 256 than\n    // to === null.  Not sure why, but CompareStub_EQ_STRICT shows up high in\n    // the profile, not sure if it's related to using a Uint8Array.\n    var trans = frame.transparent_index;\n    if (trans === null) trans = 256;\n\n    // We are possibly just blitting to a portion of the entire frame.\n    // That is a subrect within the framerect, so the additional pixels\n    // must be skipped over after we finished a scanline.\n    var framewidth  = frame.width;\n    var framestride = width - framewidth;\n    var xleft       = framewidth;  // Number of subrect pixels left in scanline.\n\n    // Output indicies of the top left and bottom right corners of the subrect.\n    var opbeg = ((frame.y * width) + frame.x) * 4;\n    var opend = ((frame.y + frame.height) * width + frame.x) * 4;\n    var op    = opbeg;\n\n    var scanstride = framestride * 4;\n\n    // Use scanstride to skip past the rows when interlacing.  This is skipping\n    // 7 rows for the first two passes, then 3 then 1.\n    if (frame.interlaced === true) {\n      scanstride += width * 4 * 7;  // Pass 1.\n    }\n\n    var interlaceskip = 8;  // Tracking the row interval in the current pass.\n\n    for (var i = 0, il = index_stream.length; i < il; ++i) {\n      var index = index_stream[i];\n\n      if (xleft === 0) {  // Beginning of new scan line\n        op += scanstride;\n        xleft = framewidth;\n        if (op >= opend) { // Catch the wrap to switch passes when interlacing.\n          scanstride = framestride * 4 + width * 4 * (interlaceskip-1);\n          // interlaceskip / 2 * 4 is interlaceskip << 1.\n          op = opbeg + (framewidth + framestride) * (interlaceskip << 1);\n          interlaceskip >>= 1;\n        }\n      }\n\n      if (index === trans) {\n        op += 4;\n      } else {\n        var r = buf[palette_offset + index * 3];\n        var g = buf[palette_offset + index * 3 + 1];\n        var b = buf[palette_offset + index * 3 + 2];\n        pixels[op++] = r;\n        pixels[op++] = g;\n        pixels[op++] = b;\n        pixels[op++] = 255;\n      }\n      --xleft;\n    }\n  };\n}\n\nfunction GifReaderLZWOutputIndexStream(code_stream, p, output, output_length) {\n  var min_code_size = code_stream[p++];\n\n  var clear_code = 1 << min_code_size;\n  var eoi_code = clear_code + 1;\n  var next_code = eoi_code + 1;\n\n  var cur_code_size = min_code_size + 1;  // Number of bits per code.\n  // NOTE: This shares the same name as the encoder, but has a different\n  // meaning here.  Here this masks each code coming from the code stream.\n  var code_mask = (1 << cur_code_size) - 1;\n  var cur_shift = 0;\n  var cur = 0;\n\n  var op = 0;  // Output pointer.\n\n  var subblock_size = code_stream[p++];\n\n  // TODO(deanm): Would using a TypedArray be any faster?  At least it would\n  // solve the fast mode / backing store uncertainty.\n  // var code_table = Array(4096);\n  var code_table = new Int32Array(4096);  // Can be signed, we only use 20 bits.\n\n  var prev_code = null;  // Track code-1.\n\n  while (true) {\n    // Read up to two bytes, making sure we always 12-bits for max sized code.\n    while (cur_shift < 16) {\n      if (subblock_size === 0) break;  // No more data to be read.\n\n      cur |= code_stream[p++] << cur_shift;\n      cur_shift += 8;\n\n      if (subblock_size === 1) {  // Never let it get to 0 to hold logic above.\n        subblock_size = code_stream[p++];  // Next subblock.\n      } else {\n        --subblock_size;\n      }\n    }\n\n    // TODO(deanm): We should never really get here, we should have received\n    // and EOI.\n    if (cur_shift < cur_code_size)\n      break;\n\n    var code = cur & code_mask;\n    cur >>= cur_code_size;\n    cur_shift -= cur_code_size;\n\n    // TODO(deanm): Maybe should check that the first code was a clear code,\n    // at least this is what you're supposed to do.  But actually our encoder\n    // now doesn't emit a clear code first anyway.\n    if (code === clear_code) {\n      // We don't actually have to clear the table.  This could be a good idea\n      // for greater error checking, but we don't really do any anyway.  We\n      // will just track it with next_code and overwrite old entries.\n\n      next_code = eoi_code + 1;\n      cur_code_size = min_code_size + 1;\n      code_mask = (1 << cur_code_size) - 1;\n\n      // Don't update prev_code ?\n      prev_code = null;\n      continue;\n    } else if (code === eoi_code) {\n      break;\n    }\n\n    // We have a similar situation as the decoder, where we want to store\n    // variable length entries (code table entries), but we want to do in a\n    // faster manner than an array of arrays.  The code below stores sort of a\n    // linked list within the code table, and then \"chases\" through it to\n    // construct the dictionary entries.  When a new entry is created, just the\n    // last byte is stored, and the rest (prefix) of the entry is only\n    // referenced by its table entry.  Then the code chases through the\n    // prefixes until it reaches a single byte code.  We have to chase twice,\n    // first to compute the length, and then to actually copy the data to the\n    // output (backwards, since we know the length).  The alternative would be\n    // storing something in an intermediate stack, but that doesn't make any\n    // more sense.  I implemented an approach where it also stored the length\n    // in the code table, although it's a bit tricky because you run out of\n    // bits (12 + 12 + 8), but I didn't measure much improvements (the table\n    // entries are generally not the long).  Even when I created benchmarks for\n    // very long table entries the complexity did not seem worth it.\n    // The code table stores the prefix entry in 12 bits and then the suffix\n    // byte in 8 bits, so each entry is 20 bits.\n\n    var chase_code = code < next_code ? code : prev_code;\n\n    // Chase what we will output, either {CODE} or {CODE-1}.\n    var chase_length = 0;\n    var chase = chase_code;\n    while (chase > clear_code) {\n      chase = code_table[chase] >> 8;\n      ++chase_length;\n    }\n\n    var k = chase;\n\n    var op_end = op + chase_length + (chase_code !== code ? 1 : 0);\n    if (op_end > output_length) {\n      console.log(\"Warning, gif stream longer than expected.\");\n      return;\n    }\n\n    // Already have the first byte from the chase, might as well write it fast.\n    output[op++] = k;\n\n    op += chase_length;\n    var b = op;  // Track pointer, writing backwards.\n\n    if (chase_code !== code)  // The case of emitting {CODE-1} + k.\n      output[op++] = k;\n\n    chase = chase_code;\n    while (chase_length--) {\n      chase = code_table[chase];\n      output[--b] = chase & 0xff;  // Write backwards.\n      chase >>= 8;  // Pull down to the prefix code.\n    }\n\n    if (prev_code !== null && next_code < 4096) {\n      code_table[next_code++] = prev_code << 8 | k;\n      // TODO(deanm): Figure out this clearing vs code growth logic better.  I\n      // have an feeling that it should just happen somewhere else, for now it\n      // is awkward between when we grow past the max and then hit a clear code.\n      // For now just check if we hit the max 12-bits (then a clear code should\n      // follow, also of course encoded in 12-bits).\n      if (next_code >= code_mask+1 && cur_code_size < 12) {\n        ++cur_code_size;\n        code_mask = code_mask << 1 | 1;\n      }\n    }\n\n    prev_code = code;\n  }\n\n  if (op !== output_length) {\n    console.log(\"Warning, gif stream shorter than expected.\");\n  }\n\n  return output;\n}\n\n// CommonJS.\ntry { exports.GifWriter = GifWriter; exports.GifReader = GifReader; } catch(e) {}\n});\nvar omggif_1 = omggif.GifWriter;\nvar omggif_2 = omggif.GifReader;\n\nvar ImgMessage$1 = /** @class */ (function (_super) {\r\n    __extends(ImgMessage, _super);\r\n    function ImgMessage(msg) {\r\n        var _this_1 = _super.call(this) || this;\r\n        _this_1.ImgMessageConfig = {\r\n            url: '',\r\n            width: 0,\r\n            height: 0\r\n        };\r\n        _this_1.numFrames = 0;\r\n        _this_1.currentFrameIndex = 0;\r\n        _this_1.pixels = new Uint8ClampedArray(0);\r\n        _this_1.lastFrameDate = new Date().getTime();\r\n        _this_1.ImgMessageConfig = Object.assign({}, _this_1.ImgMessageConfig, msg);\r\n        return _this_1;\r\n    }\r\n    ImgMessage.prototype.onCreate = function (cal) {\r\n        var _this = this;\r\n        ajax({\r\n            url: this.ImgMessageConfig.url,\r\n            callback: function (err, res) {\r\n                if (err) {\r\n                    console.log(err);\r\n                    cal(false);\r\n                }\r\n                else {\r\n                    // tslint:disable-next-line: no-floating-promises\r\n                    _this.newMethod(res);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    ImgMessage.prototype.newMethod = function (res) {\r\n        // tslint:disable-next-line: no-floating-promises\r\n        this.mGifReader = new omggif.GifReader(res);\r\n        this.numFrames = this.mGifReader.numFrames();\r\n        var frame0Info = this.mGifReader.frameInfo(0);\r\n        var _a = [frame0Info.width, frame0Info.height], width = _a[0], height = _a[1];\r\n        this.pixels = new Uint8ClampedArray(width * height * 4);\r\n    };\r\n    ImgMessage.prototype.onMeasure = function (ctx, trackInfo) {\r\n        var reader = this.mGifReader;\r\n        if (this.currentFrameIndex >= this.numFrames) {\r\n            this.currentFrameIndex = 0;\r\n        }\r\n        var frameInfo = {\r\n            width: this.ImgMessageConfig.width,\r\n            height: this.ImgMessageConfig.height\r\n        };\r\n        if (reader) {\r\n            frameInfo = reader.frameInfo(this.currentFrameIndex);\r\n            // this.lastFrameDate = new Date().getTime() + frameInfo.delay\r\n            reader.decodeAndBlitFrameRGBA(this.currentFrameIndex, this.pixels);\r\n        }\r\n        return {\r\n            width: this.ImgMessageConfig.width,\r\n            height: this.ImgMessageConfig.height\r\n        };\r\n    };\r\n    ImgMessage.prototype.onLayout = function (ctx, trackInfo) {\r\n        if (!this.isLayout) {\r\n            this.isLayout = true;\r\n            return {\r\n                top: trackInfo.top,\r\n                left: ctx.canvas.width\r\n            };\r\n        }\r\n        this.position.left -= 3;\r\n        return this.position;\r\n    };\r\n    ImgMessage.prototype.onDraw = function (ctx, trackInfo) {\r\n        var imageData = new ImageData(this.pixels, this.size.width, this.size.height);\r\n        ctx.putImageData(imageData, this.position.left, this.position.top);\r\n    };\r\n    ImgMessage.prototype.onDestroyed = function () {\r\n        var result = this.position.left < -this.size.width;\r\n        return result;\r\n    };\r\n    return ImgMessage;\r\n}(BaseMessage));\n\nvar VideoMessage = /** @class */ (function (_super) {\r\n    __extends(VideoMessage, _super);\r\n    function VideoMessage(msg) {\r\n        var _this = _super.call(this) || this;\r\n        _this.VideoMessageConfig = {\r\n            url: '',\r\n            width: 300,\r\n            height: 200\r\n        };\r\n        _this.mIsPlay = false;\r\n        _this.mVideo = document.createElement('video');\r\n        _this.VideoMessageConfig = Object.assign({}, _this.VideoMessageConfig, msg);\r\n        return _this;\r\n    }\r\n    VideoMessage.prototype.onCreate = function (callback) {\r\n        var _this = this;\r\n        this.mVideo.addEventListener('canplay', function () {\r\n            callback(true);\r\n        });\r\n        this.mVideo.addEventListener('error', function () {\r\n            document.body.removeChild(_this.mVideo);\r\n            callback(false);\r\n        });\r\n        this.mVideo.src = this.VideoMessageConfig.url;\r\n        this.mVideo.style.position = 'fixed';\r\n        this.mVideo.style.top = '-4000px';\r\n        this.mVideo.style.left = '-4000px';\r\n        this.mVideo.preload = 'auto';\r\n        this.mVideo.loop = true;\r\n        document.body.appendChild(this.mVideo);\r\n    };\r\n    VideoMessage.prototype.onMeasure = function (ctx, trackInfo) {\r\n        if (!this.mIsPlay) {\r\n            this.mIsPlay = true;\r\n            this.mVideo.play();\r\n        }\r\n        return {\r\n            width: this.VideoMessageConfig.width,\r\n            height: this.VideoMessageConfig.height\r\n        };\r\n    };\r\n    VideoMessage.prototype.onLayout = function (ctx, trackInfo) {\r\n        console.log(this.size);\r\n        if (!this.isLayout) {\r\n            this.isLayout = true;\r\n            return {\r\n                top: trackInfo.top,\r\n                left: ctx.canvas.width\r\n            };\r\n        }\r\n        this.position.left -= 3;\r\n        return this.position;\r\n    };\r\n    VideoMessage.prototype.onDraw = function (ctx, trackInfo) {\r\n        ctx.drawImage(this.mVideo, this.position.left, this.position.top, this.size.width, this.size.height);\r\n    };\r\n    VideoMessage.prototype.onDestroyed = function () {\r\n        var result = this.position.left < -this.size.width;\r\n        if (result) {\r\n            document.body.removeChild(this.mVideo);\r\n        }\r\n        return result;\r\n    };\r\n    return VideoMessage;\r\n}(BaseMessage));\n\nexport { Danmaku, DanmakuPool, TextMessage, ImgMessage, ImgMessage$1 as GifMessage, VideoMessage, DanmaTrack };\n//# sourceMappingURL=danmaku-plus.es5.js.map\n","<template>\n  <canvas id=\"cvs\">您浏览器不支持canvas，建议使用google浏览器</canvas>\n</template>\n\n<script>\n/*\n * Danmaku-Plus 弹幕组件\n * github https://github.com/Sailiy/Danmaku-Plus\n * 安装 npm i danmaku-plus --save\n * */\n// 引入弹幕舞台，弹幕轨道，消息缓存池，普通文字消息，图片消息，视频消息\nimport {\n  DanmakuPool,\n  DanmaTrack,\n  Danmaku,\n  TextMessage,\n  ImgMessage,\n  VideoMessage\n} from \"danmaku-plus\";\n\nexport default {\n  name: \"Danmaku\",\n  props: {\n    height: {\n      type: Number,\n      default: 231\n    },\n    width: {\n      type: Number,\n      default: window.innerWidth\n    }\n  },\n  computed: {\n    remHeight() {\n      const height = this.height;\n      const size = 75;\n      const fontSize = document.getElementsByTagName(\"html\")[0].style.fontSize;\n      return (height / size) * parseFloat(fontSize);\n    }\n  },\n  data() {\n    return {\n      danmaku: {},\n      danmakuPool: {\n        msg: {},\n        img: {},\n        video: {}\n      }\n    };\n  },\n  methods: {\n    init() {\n      const canvas = document.getElementById(\"cvs\");\n\n      //初始化弹幕组件\n      this.danmaku = new Danmaku(canvas, {\n        width: this.width,\n        height: this.remHeight\n      });\n\n      // 创建消息弹幕池\n      this.createDanmakuPool();\n      // 创建图片弹幕池\n      this.createImgDanmakuPool();\n      // 创建视频弹幕池\n      this.createVideoDanmakuPool();\n      // 开始播放弹幕\n      this.danmaku.start();\n    },\n    createDanmakuPool() {\n      //创建一个消息池子，池子得大小能容纳300条消息\n      const danmakuPool = new DanmakuPool(300);\n\n      for (let i = 0; i < 6; i++) {\n        //创建多个弹幕轨道，每个轨道应该定义距离弹幕舞台（canvas）顶部得top以及弹幕轨道得高度\n        const danmakuTrack = new DanmaTrack(danmakuPool, {\n          top: (10 + 30) * i + 10,\n          height: 30\n        });\n        //在弹幕舞台中添加该轨道\n        this.danmaku.addDanmuTrack(danmakuTrack);\n        this.danmakuPool.msg = danmakuPool;\n      }\n    },\n    createImgDanmakuPool() {\n      const imgDanmuPool = new DanmakuPool(10);\n      const imgDanmuTrack = new DanmaTrack(imgDanmuPool, {\n        top: 20,\n        height: 40\n      });\n      this.danmaku.addDanmuTrack(imgDanmuTrack);\n      this.danmakuPool.img = imgDanmuPool;\n    },\n    createVideoDanmakuPool() {\n      const videoDanmuPool = new DanmakuPool(10);\n      const videoDanmuTrack = new DanmaTrack(videoDanmuPool, {\n        top: 200,\n        height: 200\n      });\n      this.danmaku.addDanmuTrack(videoDanmuTrack);\n      this.danmakuPool.video = videoDanmuPool;\n    },\n    sendDanmaku(options) {\n      this.danmakuPool.msg.addMessage(\n        new TextMessage({\n          mMsg: options.msg,\n          color: options.color || \"#FFF\",\n          strokeColor: options.strokeColor || \"#000\",\n          fontSize: options.fontSize || 16,\n          fontFamily: options.fontFamily || \"PingFang SC\"\n        })\n      );\n    },\n    sendImgDanmaku(options) {\n      const imgDanmu = new ImgMessage({\n        url:\n          options.url ||\n          \"https://github.wdapp.top/github/res/images/icon/CC_144_144.png\",\n        width: options.width || 70,\n        height: options.height || 70\n      });\n      this.danmakuPool.img.addMessage(imgDanmu);\n    },\n    sendVideoDanmaku(options) {\n      const videoDanmu = new VideoMessage({\n        url: options.url || \"https://vjs.zencdn.net/v/oceans.mp4\",\n        width: options.width || 300,\n        height: options.height || 200\n      });\n      this.danmakuPool.video.addMessage(videoDanmu);\n    },\n    handlePause() {\n      this.danmaku.pause();\n    },\n    handleStart() {\n      this.danmaku.start();\n    }\n  },\n  mounted() {\n    this.init();\n  }\n};\n</script>\n\n<style lang=\"stylus\" scoped>\ncanvas\n  width 100%\n  height 231px\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Danmaku.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Danmaku.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Danmaku.vue?vue&type=template&id=67c696e0&scoped=true&\"\nimport script from \"./Danmaku.vue?vue&type=script&lang=js&\"\nexport * from \"./Danmaku.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Danmaku.vue?vue&type=style&index=0&id=67c696e0&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"67c696e0\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"controls-wrapper\" @click=\"handleControlsClick\">\n    <common-danmaku class=\"danmaku-wrap\" ref=\"danmaku\"></common-danmaku>\n    <div\n      class=\"controls-top\"\n      v-show=\"show\"\n      @click.self.stop=\"onControlsTopClick\"\n    >\n      <controls-back\n        class=\"controls-back\"\n        @click=\"handleControlsClick\"\n      ></controls-back>\n      <controls-button-group\n        class=\"controls-button-group\"\n        @click=\"handleControlsClick\"\n        @switch=\"onSwitch\"\n        @open=\"onOpen\"\n        :isSubShow=\"isSubShow\"\n        :hideSwitchBtn=\"hideSwitchBtn\"\n      ></controls-button-group>\n      <controls-play\n        :playState=\"playState\"\n        class=\"controls-play\"\n        @toggleplay=\"onTogglePlay\"\n        @click=\"handleControlsClick\"\n      ></controls-play>\n    </div>\n    <div class=\"controls-bottom\" v-show=\"show\">\n      <controls-control\n        @toggleplay=\"onTogglePlay\"\n        :playState=\"playState\"\n        @fullscreenclick=\"onFullScreen\"\n        :fullScreenState=\"screenState\"\n        @change=\"onDanmakuChange\"\n      ></controls-control>\n    </div>\n  </div>\n</template>\n\n<script>\n/**\n * 控制器组件\n * */\nimport ControlsPlay from \"./components/Play\";\nimport ControlsBack from \"./components/Back\";\nimport ControlsControl from \"./components/Control\";\nimport ControlsButtonGroup from \"./components/ButtonGroup\";\nimport CommonDanmaku from \"common/components/danmaku/Danmaku\";\nimport { mapState } from \"vuex\";\nimport Mixins from \"common/mixins\";\n\nexport default {\n  name: \"Controls\",\n  mixins: [Mixins],\n  components: {\n    ControlsPlay,\n    ControlsBack,\n    ControlsControl,\n    ControlsButtonGroup,\n    CommonDanmaku\n  },\n  props: {\n    isSubShow: {\n      type: Boolean,\n      default: true\n    },\n    hideSwitchBtn: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data() {\n    return {\n      show: true,\n      checked: false\n    };\n  },\n  computed: {\n    ...mapState([\"playState\", \"screenState\"]),\n    danmaku() {\n      return this.$refs.danmaku;\n    }\n  },\n  methods: {\n    onSwitch(toggle) {\n      this.$emit(\"switch\", toggle);\n    },\n    onOpen() {\n      this.$emit(\"open\");\n    },\n    handleControlsClick() {\n      this.show = true;\n      this.$emit(\"show\", this.show);\n      this.start();\n    },\n    onControlsTopClick() {\n      this.show = false;\n      this.$emit(\"show\", this.show);\n      this.abort();\n    },\n    start() {\n      this.delay(() => {\n        this.show = false;\n        this.$emit(\"show\", this.show);\n      });\n    },\n    onTogglePlay() {\n      //自定义发布订阅事件，this.bus.$emit 用于组件之间全局通信，发送主动播放事件\n      this.emit(\"toggleplay\");\n    },\n    onFullScreen() {\n      this.emit(\"fullscreenclick\");\n    },\n    onDanmakuChange(checked) {\n      this.checked = checked;\n    },\n    sendDanmaku(msg) {\n      if (this.checked) {\n        this.danmaku.sendDanmaku({\n          msg: msg\n        });\n      }\n    },\n    addEvents() {\n      this.on(\"danmaku\", msg => {\n        this.sendDanmaku(msg);\n      });\n    }\n  },\n  mounted() {\n    this.start();\n    this.addEvents();\n  }\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n@import \"~styles/mixins.styl\"\n\n.controls-wrapper\n  position absolute\n  width-height-full()\n  top 0\n  .danmaku-wrap\n    position absolute\n    top 0\n  .controls-top\n    layout(0, 0, 77px, 0)\n    .controls-back\n      display inline-block\n      margin-left 20px\n      margin-top 14px\n    .controls-button-group\n      float right\n      margin-right 18px\n      margin-top 16px\n    .controls-play\n      position absolute\n      left 50%\n      top 50%\n      margin-left -45px\n      margin-top -6.5px\n  .controls-bottom\n    position absolute\n    width 100%\n    height 77px\n    bottom 0\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Controls.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Controls.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Controls.vue?vue&type=template&id=a28b73de&scoped=true&\"\nimport script from \"./Controls.vue?vue&type=script&lang=js&\"\nexport * from \"./Controls.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Controls.vue?vue&type=style&index=0&id=a28b73de&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a28b73de\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Danmaku.vue?vue&type=style&index=0&id=67c696e0&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Danmaku.vue?vue&type=style&index=0&id=67c696e0&lang=stylus&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Play.vue?vue&type=style&index=0&id=5de8f0e2&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Play.vue?vue&type=style&index=0&id=5de8f0e2&lang=stylus&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Control.vue?vue&type=style&index=0&id=c53d83c6&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Control.vue?vue&type=style&index=0&id=c53d83c6&lang=stylus&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Controls.vue?vue&type=style&index=0&id=a28b73de&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Controls.vue?vue&type=style&index=0&id=a28b73de&lang=stylus&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ButtonGroup.vue?vue&type=style&index=0&id=21156dbc&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ButtonGroup.vue?vue&type=style&index=0&id=21156dbc&lang=stylus&scoped=true&\""],"sourceRoot":""}